1. Title & Hook
TITLE: Unsent Letters: Palimpsest Desk

HOOK:
Letters arrive with a readable “surface draft,” but some hide a truer message underneath (a palimpsest). You can file fast based on what’s obvious, or spend limited UV Lamp battery to reveal the hidden layer and file based on intent. Over five minutes, you reconstruct a relationship not just by sorting mail—but by deciding when a message deserves deeper attention.

Distinct ending at 5:00: a “Delivery Report” plus a final reconstructed note whose tone changes based on how often you filed by true intent vs surface draft.

2. Core Insight
CENTRAL TRUTH:
People often write the safe version first. The real meaning is frequently underneath—edited out, softened, or hidden.

WHY THIS MATTERS:
Players recognize this as human: texts unsent, drafts rewritten, apologies turned into jokes, fear disguised as anger. The game makes that gap playable: your limited attention (UV battery) becomes the moral/strategic resource.

3. Mechanic-theme integration
PRIMARY MECHANIC (PLAYER ACTIONS):

Letters slide toward a shredder.
Hold to Peek (shows surface draft).
While peeking, optionally hold E to activate UV Lamp (shows hidden draft) while draining battery.
File into one of five folders (1–5) by drag-drop or hotkeys.
HOW IT EMBODIES THE THEME:

Surface draft = what people can admit. Hidden draft = what they mean.
The UV Lamp battery is literally “emotional labor/attention”: you can’t deeply read everything.
Mistakes feel thematic: filing anger when it was actually fear is exactly how real misunderstandings happen.
5. Technical specification (Phaser 3; fully concrete)
Platform / Window
Phaser 3, 1280×720, Scale.FIT + CENTER_BOTH, single scene gameplay.
Target: laptop keyboard + trackpad/mouse.
Fixed duration & ending
Exact duration: 300 seconds. Always ends at 0.
End tier is based on Truthful Sorting (correct by hidden intent) and Surface Sorting (correct by surface but not hidden).
Folders (exact mapping)
Folder keys:

APOLOGY
GRATITUDE
JOY
ANGER
FEAR / WARNING
Letter structure (IMPORTANT: two layers)
Each letter has:

surfaceCategory (what surface draft suggests)
trueCategory (the intended emotional truth)
surfaceLines[3]
trueLines[3] (may be identical to surface for “single-layer” letters)
isDoubleLayer boolean (if true, surface != true and UV matters)
Display rules:

Not peeking: shows closed envelope sprite only.
Peeking (mouse hold / SPACE hold): shows surface panel and surface text.
Peeking + UV (hold E): shows true panel + true text + a purple glow overlay.
If letter is single-layer: true == surface; UV shows same text (still allowed but wastes battery).
UV Lamp battery (no further design decisions)
Battery range: 0..100
Start battery: 70
Drain: 22 units per second while UV held AND a letter is currently open
Recharge: 10 units per second when UV not held (always, even while peeking)
UV only activates if battery > 0. If battery hits 0, UV turns off automatically.
Flow / spawn / difficulty ramp
Letters move downward in a lane toward shredder (same lane layout as before).
Spawn interval ramps: spawnInterval = clamp(4.6 - (elapsedSec/300)*1.6, 2.8, 4.6)
Max active letters: 6.
Double-layer probability increases with chaos (creates evolving pressure):

doubleLayerChance = clamp(0.15 + static/120, 0.15, 0.75)
When generating a non-story letter, roll this chance to decide if it’s double-layer.
Scoring & meters (exact)
Counters:

filedCorrectTrue (filed into trueCategory)
filedCorrectSurfaceOnly (filed into surfaceCategory but not trueCategory) — happens only on double-layer letters
filedWrong (neither)
missed (shredded)
Meters:

harmony 0..100 (world warms)
static 0..100 (noise + more double-layers)
Outcomes:

If filed == trueCategory:
filedCorrectTrue++
harmony +5, static -2
Else if filed == surfaceCategory (surface-only correctness):
filedCorrectSurfaceOnly++
harmony +1, static +4 (it “looks right,” but misunderstandings accumulate)
Else (wrong):
filedWrong++
harmony -4, static +7
Missed (shredded):
missed++
harmony -6, static +11
Visuals (minimal but specific)
Desk background.
Lane rectangle + shredder warning strip.
Folder bins (5).
Letter closed sprite.
Letter open panel (surface): off-white.
Letter open panel (true/UV): bluish/purple tint + glow overlay.
Noise overlay alpha: alpha = lerp(0, 0.35, clamp((static-35)/65, 0, 1))
Warmth tint overlay based on harmony: warmAlpha = clamp((harmony-40)/60, 0, 1) * 0.25
Audio
3 music loops crossfaded by harmony (same approach as before).
UV hum sound while UV is active (volume 0.2).
SFX: correctTrue, correctSurface, wrong, shred.
Content banks (fully specified; no missing writing)
Categories: APOLOGY, GRATITUDE, JOY, ANGER, FEAR.

Surface/True templates:

Single-layer letters: surface == true (generated from “honest” banks).
Double-layer letters: surface text comes from “mask” banks; true text from “core” banks.
Use these banks exactly:

HONEST (single-layer) banks (same for surface & true):

Use the original OPENINGS/KEYLINES/CLOSINGS per category from the prior design.
MASK banks for double-layer surface drafts (what’s written on top):

MASK_OPENINGS:

ANGER: ["Just so we're clear.", "I’m not upset.", "This is fine.", "Whatever."]
JOY: ["Funny thing.", "No big deal.", "You’ll laugh at this.", "Just a quick note."]
GRATITUDE: ["Anyway—thanks, I guess.", "Sure, appreciate it.", "Noted.", "Okay, thanks."]
APOLOGY: ["If that bothered you…", "Sorry you took it that way.", "My bad, maybe.", "I didn’t mean it, technically."]
FEAR: ["Probably nothing.", "Ignore this.", "I’m overthinking.", "It’s fine, it’s fine."]
MASK_KEYLINES (note: these are intentionally misleading):

ANGER: [ "I’m just being honest.", "Don’t make this dramatic.", "You always do this.", "I’m tired of explaining basics.", "I shouldn’t have to ask twice." ]
JOY: [ "It’s kind of hilarious, actually.", "I guess something good happened.", "No reason, I’m just in a mood.", "I’m not attached to the outcome.", "Just sharing, whatever." ]
GRATITUDE: [ "You did what anyone would do.", "I noticed. That’s all.", "Consider it acknowledged.", "Don’t let it go to your head.", "You’re not the worst." ]
APOLOGY: [ "Let’s just move on.", "I don’t want to talk about it.", "I said what I said.", "I’m not changing my mind.", "Anyway, it’s in the past." ]
FEAR: [ "It’s nothing, probably.", "I’m being stupid.", "I didn’t sleep much.", "I’m sure it’ll sort itself out.", "I shouldn’t have written this." ]
MASK_CLOSINGS:

ANGER: ["—Whatever.", "—Done.", "—Don’t reply.", "—I’m fine."]
JOY: ["—lol", "—anyway", "—so yeah", "—just saying"]
GRATITUDE: ["—k", "—noted", "—fine", "—sure"]
APOLOGY: ["—moving on", "—end of discussion", "—forget it", "—ok"]
FEAR: ["—ignore me", "—sorry", "—forget this", "—never mind"]
CORE banks for double-layer true drafts (what UV reveals):

CORE_OPENINGS:

APOLOGY: ["I can’t keep dodging this.", "I need to own it.", "I owe you more than a shrug.", "I’m scared to write this honestly."]
GRATITUDE: ["I meant it when I said thank you.", "I don’t say it enough.", "This is me trying to be real.", "I’m embarrassed by how much it meant."]
JOY: ["I want to share this without pretending it’s small.", "This matters to me.", "I’m letting myself be happy.", "I needed one good thing."]
ANGER: ["I’m angry because I’m hurt.", "I’m not okay with what happened.", "I need you to hear me.", "I’m done swallowing this."]
FEAR: ["I’m afraid and I don’t know who else to tell.", "I think I’m in danger.", "Please take this seriously.", "I’m trying not to panic."]
CORE_KEYLINES:

APOLOGY: [ "I was wrong and I knew it in the moment.", "I’m sorry for the specific thing I did.", "I hurt you to protect my pride.", "I keep replaying it and hating myself.", "If you need space, I’ll respect it." ]
GRATITUDE: [ "You made me feel safe.", "I didn’t deserve your patience, but you gave it.", "I carry your kindness with me.", "Thank you for choosing me when you didn’t have to.", "You changed my week, maybe my life." ]
JOY: [ "I got what I wanted and I’m shaking.", "I’m proud of myself for once.", "I want you to be happy for me.", "I feel light again.", "I think things can improve." ]
ANGER: [ "You crossed a line and it matters.", "I felt small because of you.", "I need accountability, not excuses.", "I won’t accept this pattern again.", "I’m setting a boundary." ]
FEAR: [ "Something is watching my door at night.", "I don’t feel safe going home.", "If I vanish, this is why.", "Please don’t leave me alone in this.", "I need help." ]
CORE_CLOSINGS:

APOLOGY: ["—I’m sorry.", "—I’ll do better.", "—I mean this.", "—I’m owning it."]
GRATITUDE: ["—Thank you.", "—Truly.", "—With love.", "—I won’t forget."]
JOY: ["—Let me have this.", "—I’m smiling.", "—It’s real.", "—Share it with me."]
ANGER: ["—I need change.", "—This is a boundary.", "—Hear me.", "—No more."]
FEAR: ["—Please respond.", "—Please.", "—I’m scared.", "—Help me."]
Story letters (fixed schedule; always double-layer)
These are the spine of the 5-minute arc. Each is double-layer with a “mask” surface and a “core” true layer.

Define STORY_QUEUE (10 items only, to keep readable in 5 min), each with:
triggerAtSecond, surfaceCategory, trueCategory, surfaceLines[3], trueLines[3], tag

t=12
surfaceCategory: ANGER, trueCategory: FEAR
surface: ["Mira—", "Don’t make this dramatic.", "—J"]
true: ["Mira—", "I don’t feel safe going home.", "—J"]
2. t=34

surfaceCategory: JOY, trueCategory: APOLOGY
surface: ["Jonah,", "It’s kind of hilarious, actually.", "—M"]
true: ["Jonah,", "I was wrong and I knew it in the moment.", "—M"]
3. t=58

surfaceCategory: GRATITUDE, trueCategory: GRATITUDE (honest, but still UV-tinted for story effect)
surface: ["To the keeper,", "Consider it acknowledged.", "—M"]
true: ["To the keeper,", "You made me feel safe.", "—M"]
4. t=82

surfaceCategory: APOLOGY, trueCategory: ANGER
surface: ["Mira—", "Let’s just move on.", "—J"]
true: ["Mira—", "You crossed a line and it matters.", "—J"]
5. t=108

surfaceCategory: FEAR, trueCategory: FEAR
surface: ["Mira,", "I’m overthinking.", "—J"]
true: ["Mira,", "Something is watching my door at night.", "—J"]
6. t=136

surfaceCategory: ANGER, trueCategory: APOLOGY
surface: ["Jonah—", "You always do this.", "—M"]
true: ["Jonah—", "I hurt you to protect my pride.", "—M"]
7. t=168

surfaceCategory: JOY, trueCategory: JOY
surface: ["Mira!", "No reason, I’m just in a mood.", "—J"]
true: ["Mira!", "I’m proud of myself for once.", "—J"]
8. t=202

surfaceCategory: GRATITUDE, trueCategory: FEAR
surface: ["Jonah,", "You did what anyone would do.", "—M"]
true: ["Jonah,", "Please don’t leave me alone in this.", "—M"]
9. t=236

surfaceCategory: APOLOGY, trueCategory: GRATITUDE
surface: ["Mira—", "I don’t want to talk about it.", "—J"]
true: ["Mira—", "Thank you for choosing me when you didn’t have to.", "—J"]
10. t=272

surfaceCategory: FEAR, trueCategory: JOY
surface: ["(unsent)", "Ignore this.", "—"]
true: ["(unsent)", "I think things can improve.", "—"]
Ending (deterministic; distinct final note)
At t=300 compute:

truthRate = filedCorrectTrue / max(1, (filedCorrectTrue + filedCorrectSurfaceOnly + filedWrong))
chaos = static
Choose ending:

GOOD if truthRate >= 0.65 AND chaos <= 45
MIXED if truthRate between 0.40..0.64
BAD otherwise
Final reconstructed note (display exactly; no branching text beyond tier):

GOOD: "Some drafts were masks. You looked anyway. The real words survived."
MIXED: "You saved some truth, filed some masks. The story is readable, but bruised."
BAD: "The desk kept the safe versions. The true ones burned away under static."
6. Implementation pseudo code (Phaser 3; no extra creative decisions required)
CONSTANTS
- GAME_W/H = 1280/720
- DURATION = 300
- MAX_ACTIVE = 6
- PEEK_OPEN_DELAY = 0.12

LANE: x1=240 x2=1040 yTop=140 yBottom=460
SHREDDER_Y=460

FOLDERS:
  index->cat: [APOLOGY, GRATITUDE, JOY, ANGER, FEAR]
  keys 1..5 map to those categories

METERS:
  harmony 0..100 start 20
  static  0..100 start 10
  uvBattery 0..100 start 70
  UV_DRAIN_PER_SEC = 22
  UV_RECHARGE_PER_SEC = 10

SCORING EFFECTS:
  onTrueCorrect: harmony+5 static-2
  onSurfaceOnly: harmony+1 static+4
  onWrong: harmony-4 static+7
  onMissed: harmony-6 static+11

SPAWN:
  spawnInterval = clamp(4.6 - (elapsed/300)*1.6, 2.8, 4.6)
  doubleLayerChance = clamp(0.15 + static/120, 0.15, 0.75)

LETTER DATA STRUCT:
  id
  surfaceCategory, trueCategory
  surfaceLines[3], trueLines[3]
  isDoubleLayer
  speed
  isStory
  isOpen
  uvActiveOnThisLetter (visual only; computed each frame)

SCENES:
  Boot -> Preload -> Menu -> Game -> End

---------------------------------------
GameScene.create()
---------------------------------------
- init timers, counters:
  elapsed=0; timeLeft=300
  filedCorrectTrue=0; filedCorrectSurfaceOnly=0; filedWrong=0; missed=0
  harmony=20; static=10; uvBattery=70
  storyIndex=0
  letters=[]; selectedLetter=null
  spawnAcc=0

- build UI:
  background
  lane graphics
  shredder strip
  folder bins with rect hit areas
  HUD texts: timer, counts, meters
  uvBattery bar
  noise overlay (alpha 0)
  warm overlay (alpha 0)

- audio:
  loops cold/neutral/warm + uvHum
  sfx: trueCorrect, surfaceCorrect, wrong, shred

- input:
  pointer down/up for peek hold logic
  drag letters
  keyboard:
    SPACE down/up => peek selected
    E down/up => UV toggle while peeking
    1..5 => file selected into category
    ESC optional pause (if implemented, pause elapsed + movement + spawn)

---------------------------------------
GameScene.update(time, deltaMs)
---------------------------------------
delta = deltaMs/1000
elapsed += delta
timeLeft = max(0, 300 - elapsed)

1) Update selectedLetter = highest-y letter not dragging (or last clicked if exists and alive)

2) Handle mouse peek-hold:
   - if pointer is down on a letter and not dragging:
     - if held >= 0.12s => letter.openSurface()
   - on pointer up => letter.close()

3) UV system (global battery + per-letter display):
   uvKeyHeld = keyboard.E.isDown
   isPeeking = (selectedLetter != null && selectedLetter.isOpen == true)  OR (any letter open via mouse)
   uvShouldBeOn = uvKeyHeld && isPeeking && uvBattery > 0

   if uvShouldBeOn:
     uvBattery -= UV_DRAIN_PER_SEC * delta
     if uvBattery <= 0: uvBattery=0; uvShouldBeOn=false
   else:
     uvBattery += UV_RECHARGE_PER_SEC * delta
     uvBattery = clamp(uvBattery, 0, 100)

   For each open letter:
     if uvShouldBeOn:
       letter.showTrueLayer()
     else:
       letter.showSurfaceLayer()

4) Spawning:
   spawnAcc += delta
   interval = clamp(4.6 - (elapsed/300)*1.6, 2.8, 4.6)
   if timeLeft > 0 AND letters.length < 6 AND spawnAcc >= interval:
     spawnAcc = 0
     spawnLetter()

5) Move letters:
   for letter in letters:
     if letter.isDragging: continue
     letter.y += letter.speed * delta
     letter.x = clamp(letter.x, LANE.x1+120, LANE.x2-120)
     if letter.y >= SHREDDER_Y:
       handleMissed(letter)

6) Visual/audio mixing:
   noiseAlpha = lerp(0, 0.35, clamp((static-35)/65,0,1))
   warmAlpha  = clamp((harmony-40)/60,0,1) * 0.25
   set overlay alphas

   music crossfade by harmony (same formula as earlier)
   uvHum volume = uvShouldBeOn ? 0.2 : 0

7) If timeLeft == 0 => endGame()

---------------------------------------
spawnLetter()
---------------------------------------
if storyIndex < STORY_QUEUE.length AND elapsed >= STORY_QUEUE[storyIndex].t:
  d = STORY_QUEUE[storyIndex]; storyIndex++
  letterData = {
    id:"story_"+d.tag,
    isStory:true,
    isDoubleLayer:true,
    surfaceCategory:d.surfaceCategory,
    trueCategory:d.trueCategory,
    surfaceLines:d.surfaceLines,
    trueLines:d.trueLines,
    speed: randomBetween(55, 75)
  }
else:
  // generate non-story
  roll = randomFloat(0,1)
  isDouble = roll < clamp(0.15 + static/120, 0.15, 0.75)

  if !isDouble:
    cat = randomPick([APOLOGY,GRATITUDE,JOY,ANGER,FEAR])
    lines = generateHonestLines(cat)
    letterData = {
      id:"gen_"+uid(),
      isStory:false,
      isDoubleLayer:false,
      surfaceCategory:cat,
      trueCategory:cat,
      surfaceLines:lines,
      trueLines:lines,
      speed: randomBetween(60, 90)
    }
  else:
    // double-layer: choose trueCategory first, then choose a masking surfaceCategory different from true
    trueCat = randomPick([APOLOGY,GRATITUDE,JOY,ANGER,FEAR])
    surfaceCat = randomPick([all cats except trueCat])
    surfaceLines = generateMaskLines(surfaceCat)
    trueLines = generateCoreLines(trueCat)
    letterData = { ... as above, with isDoubleLayer=true ... }

Create LetterContainer at x random [520..760], y=110, add to letters

---------------------------------------
generateHonestLines(cat)
---------------------------------------
return [
  randomPick(HONEST_OPENINGS[cat]),
  randomPick(HONEST_KEYLINES[cat]),
  randomPick(HONEST_CLOSINGS[cat])
]

generateMaskLines(cat):
return [randomPick(MASK_OPENINGS[cat]), randomPick(MASK_KEYLINES[cat]), randomPick(MASK_CLOSINGS[cat])]

generateCoreLines(cat):
return [randomPick(CORE_OPENINGS[cat]), randomPick(CORE_KEYLINES[cat]), randomPick(CORE_CLOSINGS[cat])]

---------------------------------------
Filing logic (drag drop or 1..5)
---------------------------------------
fileLetter(letter, chosenCat):
  if chosenCat == letter.trueCategory:
    filedCorrectTrue++
    harmony = clamp(harmony+5,0,100)
    static  = clamp(static-2,0,100)
    play sfx_trueCorrect
  else if chosenCat == letter.surfaceCategory:
    filedCorrectSurfaceOnly++
    harmony = clamp(harmony+1,0,100)
    static  = clamp(static+4,0,100)
    play sfx_surfaceCorrect
  else:
    filedWrong++
    harmony = clamp(harmony-4,0,100)
    static  = clamp(static+7,0,100)
    play sfx_wrong

  destroy letter

handleMissed(letter):
  missed++
  harmony = clamp(harmony-6,0,100)
  static  = clamp(static+11,0,100)
  play sfx_shred
  destroy letter

---------------------------------------
endGame()
---------------------------------------
totalFiled = filedCorrectTrue + filedCorrectSurfaceOnly + filedWrong
truthRate = filedCorrectTrue / max(1,totalFiled)

if truthRate >= 0.65 AND static <= 45:
  tier="GOOD"
  msg="Some drafts were masks. You looked anyway. The real words survived."
else if truthRate >= 0.40 AND truthRate <= 0.64:
  tier="MIXED"
  msg="You saved some truth, filed some masks. The story is readable, but bruised."
else:
  tier="BAD"
  msg="The desk kept the safe versions. The true ones burned away under static."

stop loops; go to EndScene with stats + tier + msg

---------------------------------------
EndScene
---------------------------------------
Display:
- Title: "PALIMPSEST DESK — {tier}"
- Stats:
  "True-sorted: X"
  "Surface-only: Y"
  "Wrong: Z"
  "Missed: M"
  "Truth Rate: NN%"
  "Harmony: H  Static: S"
- Final msg (tier text)
- ENTER => Menu