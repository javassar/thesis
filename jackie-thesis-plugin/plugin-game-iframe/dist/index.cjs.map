{"version":3,"file":"index.cjs","sources":["../package.json","../src/index.ts"],"sourcesContent":["{\n  \"name\": \"plugin-game-iframe\",\n  \"version\": \"0.0.1\",\n  \"description\": \"Embed an HTML/JS game in a full-screen iframe with input logging and drawer UI\",\n  \"type\": \"module\",\n  \"main\": \"dist/index.cjs\",\n  \"exports\": {\n    \"import\": \"./dist/index.js\",\n    \"require\": \"./dist/index.cjs\"\n  },\n  \"typings\": \"dist/index.d.ts\",\n  \"unpkg\": \"dist/index.browser.min.js\",\n  \"files\": [\n    \"src\",\n    \"dist\"\n  ],\n  \"source\": \"src/index.ts\",\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:watch\": \"npm test -- --watch\",\n    \"tsc\": \"tsc\",\n    \"build\": \"rollup --config\",\n    \"build:watch\": \"npm run build -- --watch\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"\",\n    \"directory\": \"./\"\n  },\n  \"keywords\": [\n    \"jsPsych\"\n  ],\n  \"author\": {\n    \"name\": \"Jackie\",\n    \"url\": \"\"\n  },\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"/issues\"\n  },\n  \"homepage\": \"/plugin-game-iframe/README.md\",\n  \"dependencies\": {\n    \"jspsych\": \"^8.0.0\",\n    \"@citation-js/core\": \"^0.7.14\",\n    \"@citation-js/plugin-software-formats\": \"^0.6.1\",\n    \"@citation-js/plugin-bibtex\": \"^0.7.14\",\n    \"@citation-js/plugin-cff\": \"^0.6.1\"\n  },\n  \"devDependencies\": {\n    \"@jspsych/config\": \"^3.2.2\",\n    \"@jspsych/test-utils\": \"^1.0.0\"\n  }\n}\n","import { JsPsych, JsPsychPlugin, ParameterType, TrialType } from \"jspsych\";\n\nimport { version } from \"../package.json\";\n\nconst info = <const>{\n  name: \"plugin-game-iframe\",\n  version: version,\n  parameters: {\n    /** Path to the game HTML file (used as iframe src). Must be same-origin for input logging. */\n    game_url: {\n      type: ParameterType.STRING,\n      default: undefined,\n    },\n    /** The `type` field value in postMessage that signals the game is done. */\n    post_message_type: {\n      type: ParameterType.STRING,\n      default: \"game-complete\",\n    },\n    /** Whether to show a manual \"End Game\" button after a delay. */\n    allow_manual_end: {\n      type: ParameterType.BOOL,\n      default: false,\n    },\n    /** Milliseconds before the manual end button appears (if allow_manual_end is true). */\n    manual_end_delay: {\n      type: ParameterType.INT,\n      default: 60000,\n    },\n    /** Label for the drawer toggle tab on the right edge. */\n    drawer_button_label: {\n      type: ParameterType.STRING,\n      default: \"Menu\",\n    },\n    /** Label for the emergency exit button inside the drawer. */\n    emergency_button_label: {\n      type: ParameterType.STRING,\n      default: \"Report a Technical Issue\",\n    },\n    /** Label for the manual end button inside the drawer. */\n    manual_end_button_label: {\n      type: ParameterType.STRING,\n      default: \"End Game\",\n    },\n    /** Prompt text displayed above the emergency text area. */\n    emergency_text_prompt: {\n      type: ParameterType.HTML_STRING,\n      default: \"Please describe the technical issue you experienced:\",\n    },\n    /** Whether to record mouse events (mousemove, mousedown, mouseup, click). */\n    record_mouse_events: {\n      type: ParameterType.BOOL,\n      default: false,\n    },\n    /** Minimum milliseconds between mousemove samples. 0 means capture all events. Only used when record_mouse_events is true. */\n    mouse_sample_interval: {\n      type: ParameterType.INT,\n      default: 0,\n    },\n  },\n  data: {\n    /** The reason the trial ended: \"game-complete\", \"emergency-exit\", or \"manual-end\". */\n    exit_reason: {\n      type: ParameterType.STRING,\n    },\n    /** Reaction time in milliseconds from trial start to trial end. */\n    rt: {\n      type: ParameterType.INT,\n    },\n    /** Data payload from the game's postMessage, or null. */\n    game_data: {\n      type: ParameterType.COMPLEX,\n    },\n    /** Text entered in the emergency exit form, or null. */\n    emergency_text: {\n      type: ParameterType.STRING,\n    },\n    /** Array of keystroke events: { key, event, t }. */\n    keystrokes: {\n      type: ParameterType.COMPLEX,\n    },\n    /** Array of mouse events: { x, y, t, event }. */\n    mouse_events: {\n      type: ParameterType.COMPLEX,\n    },\n  },\n  citations: \"__CITATIONS__\",\n};\n\ntype Info = typeof info;\n\n/**\n * **plugin-game-iframe**\n *\n * Embed an HTML/JS game in a full-screen iframe with input logging and drawer UI.\n *\n * @author Jackie\n * @see {@link /plugin-game-iframe/README.md}\n */\nclass GameIframePlugin implements JsPsychPlugin<Info> {\n  static info = info;\n\n  constructor(private jsPsych: JsPsych) {}\n\n  trial(display_element: HTMLElement, trial: TrialType<Info>) {\n    const startTime = performance.now();\n    let trialEnded = false;\n\n    // Data arrays\n    const keystrokes: Array<{\n      key: string;\n      event: \"keydown\" | \"keyup\";\n      t: number;\n    }> = [];\n    const mouse_events: Array<{\n      x: number;\n      y: number;\n      t: number;\n      event: string;\n    }> = [];\n\n    // Track last mouse sample time for throttling\n    let lastMouseSampleTime = 0;\n\n    // Track all listeners for cleanup\n    const cleanupFns: Array<() => void> = [];\n\n    // ── CSS ──────────────────────────────────────────────────────────────\n\n    const style = document.createElement(\"style\");\n    style.textContent = `\n      .gi-container {\n        position: fixed;\n        top: 0; left: 0; width: 100vw; height: 100vh;\n        z-index: 10000;\n        background: #000;\n      }\n      .gi-iframe {\n        width: 100%; height: 100%;\n        border: none;\n      }\n\n      /* Drawer tab */\n      .gi-drawer-tab {\n        position: fixed;\n        top: 50%; right: 0;\n        transform: translateY(-50%);\n        z-index: 10002;\n        writing-mode: vertical-rl;\n        text-orientation: mixed;\n        padding: 12px 6px;\n        background: #444;\n        color: #fff;\n        border: none;\n        border-radius: 6px 0 0 6px;\n        cursor: pointer;\n        font-size: 14px;\n        font-family: sans-serif;\n        letter-spacing: 1px;\n      }\n      .gi-drawer-tab:hover {\n        background: #666;\n      }\n\n      /* Drawer panel */\n      .gi-drawer-panel {\n        position: fixed;\n        top: 0; right: -320px;\n        width: 320px; height: 100vh;\n        background: #f5f5f5;\n        z-index: 10003;\n        transition: right 0.25s ease;\n        display: flex;\n        flex-direction: column;\n        font-family: sans-serif;\n        box-shadow: -2px 0 8px rgba(0,0,0,0.3);\n      }\n      .gi-drawer-panel.open {\n        right: 0;\n      }\n      .gi-drawer-header {\n        display: flex;\n        justify-content: flex-end;\n        padding: 8px 12px;\n        border-bottom: 1px solid #ddd;\n      }\n      .gi-drawer-close {\n        background: none;\n        border: none;\n        font-size: 24px;\n        cursor: pointer;\n        color: #333;\n        padding: 4px 8px;\n      }\n      .gi-drawer-body {\n        padding: 20px;\n        flex: 1;\n        overflow-y: auto;\n      }\n\n      /* Emergency button */\n      .gi-emergency-btn {\n        width: 100%;\n        padding: 12px;\n        background: #d32f2f;\n        color: #fff;\n        border: none;\n        border-radius: 6px;\n        font-size: 15px;\n        cursor: pointer;\n        margin-bottom: 16px;\n      }\n      .gi-emergency-btn:hover {\n        background: #b71c1c;\n      }\n\n      /* Emergency form */\n      .gi-emergency-form {\n        display: none;\n        margin-bottom: 16px;\n      }\n      .gi-emergency-form.visible {\n        display: block;\n      }\n      .gi-emergency-form label {\n        display: block;\n        margin-bottom: 8px;\n        font-size: 14px;\n        color: #333;\n      }\n      .gi-emergency-form textarea {\n        width: 100%;\n        height: 100px;\n        padding: 8px;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        font-size: 14px;\n        resize: vertical;\n        box-sizing: border-box;\n        margin-bottom: 8px;\n      }\n      .gi-emergency-submit {\n        width: 100%;\n        padding: 10px;\n        background: #d32f2f;\n        color: #fff;\n        border: none;\n        border-radius: 6px;\n        font-size: 14px;\n        cursor: pointer;\n      }\n      .gi-emergency-submit:hover {\n        background: #b71c1c;\n      }\n\n      /* Manual end button */\n      .gi-manual-end-btn {\n        width: 100%;\n        padding: 12px;\n        background: #1565c0;\n        color: #fff;\n        border: none;\n        border-radius: 6px;\n        font-size: 15px;\n        cursor: pointer;\n        display: none;\n      }\n      .gi-manual-end-btn:hover {\n        background: #0d47a1;\n      }\n      .gi-manual-end-btn.visible {\n        display: block;\n      }\n\n      /* Overlay behind drawer */\n      .gi-overlay {\n        position: fixed;\n        top: 0; left: 0;\n        width: 100vw; height: 100vh;\n        background: rgba(0,0,0,0.4);\n        z-index: 10001;\n        display: none;\n      }\n      .gi-overlay.visible {\n        display: block;\n      }\n    `;\n    document.head.appendChild(style);\n    cleanupFns.push(() => style.remove());\n\n    // ── DOM ──────────────────────────────────────────────────────────────\n\n    // Full-screen container\n    const container = document.createElement(\"div\");\n    container.className = \"gi-container\";\n\n    // Iframe\n    const iframe = document.createElement(\"iframe\");\n    iframe.className = \"gi-iframe\";\n    iframe.src = trial.game_url;\n    container.appendChild(iframe);\n\n    // Overlay\n    const overlay = document.createElement(\"div\");\n    overlay.className = \"gi-overlay\";\n    container.appendChild(overlay);\n\n    // Drawer tab\n    const drawerTab = document.createElement(\"button\");\n    drawerTab.className = \"gi-drawer-tab\";\n    drawerTab.textContent = trial.drawer_button_label;\n    container.appendChild(drawerTab);\n\n    // Drawer panel\n    const drawerPanel = document.createElement(\"div\");\n    drawerPanel.className = \"gi-drawer-panel\";\n\n    // Drawer header with close button\n    const drawerHeader = document.createElement(\"div\");\n    drawerHeader.className = \"gi-drawer-header\";\n    const closeBtn = document.createElement(\"button\");\n    closeBtn.className = \"gi-drawer-close\";\n    closeBtn.innerHTML = \"&times;\";\n    drawerHeader.appendChild(closeBtn);\n    drawerPanel.appendChild(drawerHeader);\n\n    // Drawer body\n    const drawerBody = document.createElement(\"div\");\n    drawerBody.className = \"gi-drawer-body\";\n\n    // Emergency button\n    const emergencyBtn = document.createElement(\"button\");\n    emergencyBtn.className = \"gi-emergency-btn\";\n    emergencyBtn.textContent = trial.emergency_button_label;\n    drawerBody.appendChild(emergencyBtn);\n\n    // Emergency form (hidden initially)\n    const emergencyForm = document.createElement(\"div\");\n    emergencyForm.className = \"gi-emergency-form\";\n\n    const emergencyLabel = document.createElement(\"label\");\n    emergencyLabel.innerHTML = trial.emergency_text_prompt;\n    emergencyForm.appendChild(emergencyLabel);\n\n    const emergencyTextarea = document.createElement(\"textarea\");\n    emergencyForm.appendChild(emergencyTextarea);\n\n    const emergencySubmit = document.createElement(\"button\");\n    emergencySubmit.className = \"gi-emergency-submit\";\n    emergencySubmit.textContent = \"Submit & Exit\";\n    emergencyForm.appendChild(emergencySubmit);\n\n    drawerBody.appendChild(emergencyForm);\n\n    // Manual end button (hidden initially)\n    const manualEndBtn = document.createElement(\"button\");\n    manualEndBtn.className = \"gi-manual-end-btn\";\n    manualEndBtn.textContent = trial.manual_end_button_label;\n    drawerBody.appendChild(manualEndBtn);\n\n    drawerPanel.appendChild(drawerBody);\n    container.appendChild(drawerPanel);\n\n    display_element.appendChild(container);\n\n    // ── Drawer logic ────────────────────────────────────────────────────\n\n    const openDrawer = () => {\n      drawerPanel.classList.add(\"open\");\n      overlay.classList.add(\"visible\");\n    };\n\n    const closeDrawer = () => {\n      drawerPanel.classList.remove(\"open\");\n      overlay.classList.remove(\"visible\");\n      // Re-focus iframe so keyboard input reaches the game\n      iframe.focus();\n    };\n\n    drawerTab.addEventListener(\"click\", openDrawer);\n    closeBtn.addEventListener(\"click\", closeDrawer);\n    overlay.addEventListener(\"click\", closeDrawer);\n\n    // Emergency flow\n    emergencyBtn.addEventListener(\"click\", () => {\n      emergencyForm.classList.add(\"visible\");\n      emergencyBtn.style.display = \"none\";\n    });\n\n    emergencySubmit.addEventListener(\"click\", () => {\n      endTrial(\"emergency-exit\", null, emergencyTextarea.value || null);\n    });\n\n    // Manual end\n    manualEndBtn.addEventListener(\"click\", () => {\n      endTrial(\"manual-end\", null, null);\n    });\n\n    // Show manual end button after delay\n    if (trial.allow_manual_end) {\n      this.jsPsych.pluginAPI.setTimeout(() => {\n        manualEndBtn.classList.add(\"visible\");\n      }, trial.manual_end_delay);\n    }\n\n    // ── Event logging ───────────────────────────────────────────────────\n\n    const logKey = (e: KeyboardEvent) => {\n      keystrokes.push({\n        key: e.key,\n        event: e.type as \"keydown\" | \"keyup\",\n        t: Math.round(performance.now() - startTime),\n      });\n    };\n\n    const logMouse = (e: MouseEvent) => {\n      const now = performance.now();\n      if (\n        trial.mouse_sample_interval > 0 &&\n        e.type === \"mousemove\" &&\n        now - lastMouseSampleTime < trial.mouse_sample_interval\n      ) {\n        return;\n      }\n      if (e.type === \"mousemove\") {\n        lastMouseSampleTime = now;\n      }\n      mouse_events.push({\n        x: e.clientX,\n        y: e.clientY,\n        t: Math.round(now - startTime),\n        event: e.type,\n      });\n    };\n\n    // Attach listeners on main document\n    const keyEvents = [\"keydown\", \"keyup\"] as const;\n    const mouseEventTypes = [\n      \"mousemove\",\n      \"mousedown\",\n      \"mouseup\",\n      \"click\",\n    ] as const;\n\n    for (const evt of keyEvents) {\n      document.addEventListener(evt, logKey, true);\n      cleanupFns.push(() =>\n        document.removeEventListener(evt, logKey, true)\n      );\n    }\n\n    if (trial.record_mouse_events) {\n      for (const evt of mouseEventTypes) {\n        document.addEventListener(evt, logMouse, true);\n        cleanupFns.push(() =>\n          document.removeEventListener(evt, logMouse, true)\n        );\n      }\n    }\n\n    // Attach listeners on iframe document after it loads\n    const attachIframeListeners = () => {\n      try {\n        const iframeDoc = iframe.contentDocument;\n        if (!iframeDoc) return;\n\n        for (const evt of keyEvents) {\n          iframeDoc.addEventListener(evt, logKey, true);\n          cleanupFns.push(() =>\n            iframeDoc.removeEventListener(evt, logKey, true)\n          );\n        }\n\n        if (trial.record_mouse_events) {\n          for (const evt of mouseEventTypes) {\n            iframeDoc.addEventListener(evt, logMouse, true);\n            cleanupFns.push(() =>\n              iframeDoc.removeEventListener(evt, logMouse, true)\n            );\n          }\n        }\n      } catch (e) {\n        // Cross-origin: can't attach listeners to iframe document\n        console.warn(\n          \"plugin-game-iframe: Could not attach listeners to iframe (cross-origin?).\",\n          e\n        );\n      }\n    };\n\n    iframe.addEventListener(\"load\", () => {\n      attachIframeListeners();\n      iframe.focus();\n    });\n\n    // ── postMessage listener ────────────────────────────────────────────\n\n    const messageHandler = (event: MessageEvent) => {\n      if (\n        event.data &&\n        typeof event.data === \"object\" &&\n        event.data.type === trial.post_message_type\n      ) {\n        endTrial(\"game-complete\", event.data.data ?? null, null);\n      }\n    };\n\n    window.addEventListener(\"message\", messageHandler);\n    cleanupFns.push(() =>\n      window.removeEventListener(\"message\", messageHandler)\n    );\n\n    // ── End trial ───────────────────────────────────────────────────────\n\n    const endTrial = (\n      exit_reason: string,\n      game_data: any | null,\n      emergency_text: string | null\n    ) => {\n      if (trialEnded) return;\n      trialEnded = true;\n\n      const rt = Math.round(performance.now() - startTime);\n\n      // Cleanup all listeners\n      for (const fn of cleanupFns) {\n        fn();\n      }\n\n      // Remove DOM\n      container.remove();\n\n      this.jsPsych.finishTrial({\n        exit_reason,\n        rt,\n        game_data,\n        emergency_text,\n        keystrokes,\n        mouse_events,\n      });\n    };\n  }\n}\n\nexport default GameIframePlugin;\n"],"names":["ParameterType"],"mappings":"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"}